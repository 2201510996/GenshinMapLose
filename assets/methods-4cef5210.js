import{m as N,bG as xe,t as oe,s as Ce,Y as Se,a3 as h,a4 as ze,a7 as Ne,ae as ye,a2 as de,aF as be,af as pe,an as ie,bH as ge,bI as Oe,bJ as Re,b3 as ke,V as Ie,aU as $e,a as S,bK as Ae,a6 as Be,O as fe,n as _e,P as Ee,o as x,av as me,i as I,j as z,e as L,h as _,u as o,d as ve,aN as Me,g as O,E as V,b1 as Pe,c as P,F as le,bL as Ve,bM as We,bN as Fe,bm as He,aw as Xe,bO as Ye,bP as De,f as Ke,w as je,aK as Ue,ap as re,aV as Ze,aW as Ge,aq as Te,ah as j,ac as K,bQ as qe,aB as Le,aG as Je,aL as Qe,aT as et,am as tt,ay as nt,bR as at,bA as st}from"./index-240abc48.js";const rt=(e,a)=>{if(!N||!e||!a)return!1;const t=e.getBoundingClientRect();let n;return a instanceof Element?n=a.getBoundingClientRect():n={top:0,right:window.innerWidth,bottom:window.innerHeight,left:0},t.top<n.bottom&&t.bottom>n.top&&t.right>n.left&&t.left<n.right};var ot=/\s/;function lt(e){for(var a=e.length;a--&&ot.test(e.charAt(a)););return a}var it=/^\s+/;function ut(e){return e&&e.slice(0,lt(e)+1).replace(it,"")}var we=0/0,ct=/^[-+]0x[0-9a-f]+$/i,dt=/^0b[01]+$/i,ft=/^0o[0-7]+$/i,mt=parseInt;function he(e){if(typeof e=="number")return e;if(xe(e))return we;if(oe(e)){var a=typeof e.valueOf=="function"?e.valueOf():e;e=oe(a)?a+"":a}if(typeof e!="string")return e===0?e:+e;e=ut(e);var t=dt.test(e);return t||ft.test(e)?mt(e.slice(2),t?2:8):ct.test(e)?we:+e}var vt=function(){return Ce.Date.now()};const ue=vt;var pt="Expected a function",gt=Math.max,wt=Math.min;function ht(e,a,t){var n,l,d,i,v,p,y=0,E=!1,b=!1,g=!0;if(typeof e!="function")throw new TypeError(pt);a=he(a)||0,oe(t)&&(E=!!t.leading,b="maxWait"in t,d=b?gt(he(t.maxWait)||0,a):d,g="trailing"in t?!!t.trailing:g);function w(c){var k=n,A=l;return n=l=void 0,y=c,i=e.apply(A,k),i}function m(c){return y=c,v=setTimeout($,a),E?w(c):i}function W(c){var k=c-p,A=c-y,Y=a-k;return b?wt(Y,d-A):Y}function R(c){var k=c-p,A=c-y;return p===void 0||k>=a||k<0||b&&A>=d}function $(){var c=ue();if(R(c))return X(c);v=setTimeout($,W(c))}function X(c){return v=void 0,g&&n?w(c):(n=l=void 0,i)}function U(){v!==void 0&&clearTimeout(v),y=0,n=p=l=v=void 0}function F(){return v===void 0?i:X(ue())}function H(){var c=ue(),k=R(c);if(n=arguments,l=this,p=c,k){if(v===void 0)return m(p);if(b)return clearTimeout(v),v=setTimeout($,a),w(p)}return v===void 0&&(v=setTimeout($,a)),i}return H.cancel=U,H.flush=F,H}var yt="Expected a function";function ce(e,a,t){var n=!0,l=!0;if(typeof e!="function")throw new TypeError(yt);return oe(t)&&(n="leading"in t?!!t.leading:n,l="trailing"in t?!!t.trailing:l),ht(e,a,{leading:n,maxWait:a,trailing:l})}const bt=(e,a)=>{if(!N)return!1;const t={undefined:"overflow",true:"overflow-y",false:"overflow-x"}[String(a)],n=Se(e,t);return["scroll","auto","overlay"].some(l=>n.includes(l))},kt=(e,a)=>{if(!N)return;let t=e;for(;t;){if([window,document,document.documentElement].includes(t))return window;if(bt(t,a))return t;t=t.parentNode}return t};let ae;const Wt=e=>{var a;if(!N)return 0;if(ae!==void 0)return ae;const t=document.createElement("div");t.className=`${e}-scrollbar__wrap`,t.style.visibility="hidden",t.style.width="100px",t.style.position="absolute",t.style.top="-9999px",document.body.appendChild(t);const n=t.offsetWidth;t.style.overflow="scroll";const l=document.createElement("div");l.style.width="100%",t.appendChild(l);const d=l.offsetWidth;return(a=t.parentNode)==null||a.removeChild(t),ae=n-d,ae};function Ft(e,a){if(!N)return;if(!a){e.scrollTop=0;return}const t=[];let n=a.offsetParent;for(;n!==null&&e!==n&&e.contains(n);)t.push(n),n=n.offsetParent;const l=a.offsetTop+t.reduce((p,y)=>p+y.offsetTop,0),d=l+a.offsetHeight,i=e.scrollTop,v=i+e.clientHeight;l<i?e.scrollTop=l:d>v&&(e.scrollTop=d-e.clientHeight)}const It=["class","style"],_t=/^on[A-Z]/,Et=(e={})=>{const{excludeListeners:a=!1,excludeKeys:t}=e,n=h(()=>((t==null?void 0:t.value)||[]).concat(It)),l=ze();return l?h(()=>{var d;return Ne(Object.entries((d=l.proxy)==null?void 0:d.$attrs).filter(([i])=>!n.value.includes(i)&&!(a&&_t.test(i))))}):h(()=>({}))},Tt=ye({urlList:{type:de(Array),default:()=>be([])},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},hideOnClickModal:Boolean,teleported:Boolean,closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2}}),Lt={close:()=>!0,switch:e=>pe(e)},xt=["src"],Ct=ie({name:"ElImageViewer"}),St=ie({...Ct,props:Tt,emits:Lt,setup(e,{expose:a,emit:t}){const n=e,l={CONTAIN:{name:"contain",icon:ge(Oe)},ORIGINAL:{name:"original",icon:ge(Re)}},{t:d}=ke(),i=Ie("image-viewer"),{nextZIndex:v}=$e(),p=S(),y=S([]),E=Ae(),b=S(!0),g=S(n.initialIndex),w=Be(l.CONTAIN),m=S({scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),W=h(()=>{const{urlList:s}=n;return s.length<=1}),R=h(()=>g.value===0),$=h(()=>g.value===n.urlList.length-1),X=h(()=>n.urlList[g.value]),U=h(()=>[i.e("btn"),i.e("prev"),i.is("disabled",!n.infinite&&R.value)]),F=h(()=>[i.e("btn"),i.e("next"),i.is("disabled",!n.infinite&&$.value)]),H=h(()=>{const{scale:s,deg:u,offsetX:f,offsetY:T,enableTransition:B}=m.value;let C=f/s,M=T/s;switch(u%360){case 90:case-270:[C,M]=[M,-C];break;case 180:case-180:[C,M]=[-C,-M];break;case 270:case-90:[C,M]=[-M,C];break}const D={transform:`scale(${s}) rotate(${u}deg) translate(${C}px, ${M}px)`,transition:B?"transform .3s":""};return w.value.name===l.CONTAIN.name&&(D.maxWidth=D.maxHeight="100%"),D}),c=h(()=>pe(n.zIndex)?n.zIndex:v());function k(){Y(),t("close")}function A(){const s=ce(f=>{switch(f.code){case K.esc:n.closeOnPressEscape&&k();break;case K.space:ee();break;case K.left:te();break;case K.up:r("zoomIn");break;case K.right:ne();break;case K.down:r("zoomOut");break}}),u=ce(f=>{const T=f.deltaY||f.deltaX;r(T<0?"zoomIn":"zoomOut",{zoomRate:n.zoomRate,enableTransition:!1})});E.run(()=>{j(document,"keydown",s),j(document,"wheel",u)})}function Y(){E.stop()}function q(){b.value=!1}function J(s){b.value=!1,s.target.alt=d("el.image.error")}function Q(s){if(b.value||s.button!==0||!p.value)return;m.value.enableTransition=!1;const{offsetX:u,offsetY:f}=m.value,T=s.pageX,B=s.pageY,C=ce(D=>{m.value={...m.value,offsetX:u+D.pageX-T,offsetY:f+D.pageY-B}}),M=j(document,"mousemove",C);j(document,"mouseup",()=>{M()}),s.preventDefault()}function Z(){m.value={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}function ee(){if(b.value)return;const s=qe(l),u=Object.values(l),f=w.value.name,B=(u.findIndex(C=>C.name===f)+1)%s.length;w.value=l[s[B]],Z()}function G(s){const u=n.urlList.length;g.value=(s+u)%u}function te(){R.value&&!n.infinite||G(g.value-1)}function ne(){$.value&&!n.infinite||G(g.value+1)}function r(s,u={}){if(b.value)return;const{zoomRate:f,rotateDeg:T,enableTransition:B}={zoomRate:n.zoomRate,rotateDeg:90,enableTransition:!0,...u};switch(s){case"zoomOut":m.value.scale>.2&&(m.value.scale=Number.parseFloat((m.value.scale/f).toFixed(3)));break;case"zoomIn":m.value.scale<7&&(m.value.scale=Number.parseFloat((m.value.scale*f).toFixed(3)));break;case"clockwise":m.value.deg+=T;break;case"anticlockwise":m.value.deg-=T;break}m.value.enableTransition=B}return fe(X,()=>{_e(()=>{const s=y.value[0];s!=null&&s.complete||(b.value=!0)})}),fe(g,s=>{Z(),t("switch",s)}),Ee(()=>{var s,u;A(),(u=(s=p.value)==null?void 0:s.focus)==null||u.call(s)}),a({setActiveItem:G}),(s,u)=>(x(),me(Ge,{to:"body",disabled:!s.teleported},[I(Ze,{name:"viewer-fade",appear:""},{default:z(()=>[L("div",{ref_key:"wrapper",ref:p,tabindex:-1,class:_(o(i).e("wrapper")),style:ve({zIndex:o(c)})},[L("div",{class:_(o(i).e("mask")),onClick:u[0]||(u[0]=Me(f=>s.hideOnClickModal&&k(),["self"]))},null,2),O(" CLOSE "),L("span",{class:_([o(i).e("btn"),o(i).e("close")]),onClick:k},[I(o(V),null,{default:z(()=>[I(o(Pe))]),_:1})],2),O(" ARROW "),o(W)?O("v-if",!0):(x(),P(le,{key:0},[L("span",{class:_(o(U)),onClick:te},[I(o(V),null,{default:z(()=>[I(o(Ve))]),_:1})],2),L("span",{class:_(o(F)),onClick:ne},[I(o(V),null,{default:z(()=>[I(o(We))]),_:1})],2)],64)),O(" ACTIONS "),L("div",{class:_([o(i).e("btn"),o(i).e("actions")])},[L("div",{class:_(o(i).e("actions__inner"))},[I(o(V),{onClick:u[1]||(u[1]=f=>r("zoomOut"))},{default:z(()=>[I(o(Fe))]),_:1}),I(o(V),{onClick:u[2]||(u[2]=f=>r("zoomIn"))},{default:z(()=>[I(o(He))]),_:1}),L("i",{class:_(o(i).e("actions__divider"))},null,2),I(o(V),{onClick:ee},{default:z(()=>[(x(),me(Xe(o(w).icon)))]),_:1}),L("i",{class:_(o(i).e("actions__divider"))},null,2),I(o(V),{onClick:u[3]||(u[3]=f=>r("anticlockwise"))},{default:z(()=>[I(o(Ye))]),_:1}),I(o(V),{onClick:u[4]||(u[4]=f=>r("clockwise"))},{default:z(()=>[I(o(De))]),_:1})],2)],2),O(" CANVAS "),L("div",{class:_(o(i).e("canvas"))},[(x(!0),P(le,null,Ke(s.urlList,(f,T)=>je((x(),P("img",{ref_for:!0,ref:B=>y.value[T]=B,key:f,src:f,style:ve(o(H)),class:_(o(i).e("img")),onLoad:q,onError:J,onMousedown:Q},null,46,xt)),[[Ue,T===g.value]])),128))],2),re(s.$slots,"default")],6)]),_:3})],8,["disabled"]))}});var zt=Te(St,[["__file","/home/runner/work/element-plus/element-plus/packages/components/image-viewer/src/image-viewer.vue"]]);const Nt=Le(zt),Ot=ye({hideOnClickModal:Boolean,src:{type:String,default:""},fit:{type:String,values:["","contain","cover","fill","none","scale-down"],default:""},loading:{type:String,values:["eager","lazy"]},lazy:Boolean,scrollContainer:{type:de([String,Object])},previewSrcList:{type:de(Array),default:()=>be([])},previewTeleported:Boolean,zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2}}),Rt={load:e=>e instanceof Event,error:e=>e instanceof Event,switch:e=>pe(e),close:()=>!0,show:()=>!0},$t=["src","loading"],At={key:0},Bt=ie({name:"ElImage",inheritAttrs:!1}),Mt=ie({...Bt,props:Ot,emits:Rt,setup(e,{emit:a}){const t=e;let n="";const{t:l}=ke(),d=Ie("image"),i=Je(),v=Et(),p=S(),y=S(!1),E=S(!0),b=S(!1),g=S(),w=S(),m=N&&"loading"in HTMLImageElement.prototype;let W,R;const $=h(()=>[d.e("inner"),F.value&&d.e("preview"),E.value&&d.is("loading")]),X=h(()=>i.style),U=h(()=>{const{fit:r}=t;return N&&r?{objectFit:r}:{}}),F=h(()=>{const{previewSrcList:r}=t;return Array.isArray(r)&&r.length>0}),H=h(()=>{const{previewSrcList:r,initialIndex:s}=t;let u=s;return s>r.length-1&&(u=0),u}),c=h(()=>t.loading==="eager"?!1:!m&&t.loading==="lazy"||t.lazy),k=()=>{N&&(E.value=!0,y.value=!1,p.value=t.src)};function A(r){E.value=!1,y.value=!1,a("load",r)}function Y(r){E.value=!1,y.value=!0,a("error",r)}function q(){rt(g.value,w.value)&&(k(),Z())}const J=at(q,200,!0);async function Q(){var r;if(!N)return;await _e();const{scrollContainer:s}=t;et(s)?w.value=s:tt(s)&&s!==""?w.value=(r=document.querySelector(s))!=null?r:void 0:g.value&&(w.value=kt(g.value)),w.value&&(W=j(w,"scroll",J),setTimeout(()=>q(),100))}function Z(){!N||!w.value||!J||(W==null||W(),w.value=void 0)}function ee(r){if(r.ctrlKey){if(r.deltaY<0)return r.preventDefault(),!1;if(r.deltaY>0)return r.preventDefault(),!1}}function G(){F.value&&(R=j("wheel",ee,{passive:!1}),n=document.body.style.overflow,document.body.style.overflow="hidden",b.value=!0,a("show"))}function te(){R==null||R(),document.body.style.overflow=n,b.value=!1,a("close")}function ne(r){a("switch",r)}return fe(()=>t.src,()=>{c.value?(E.value=!0,y.value=!1,Z(),Q()):k()}),Ee(()=>{c.value?Q():k()}),(r,s)=>(x(),P("div",{ref_key:"container",ref:g,class:_([o(d).b(),r.$attrs.class]),style:ve(o(X))},[y.value?re(r.$slots,"error",{key:0},()=>[L("div",{class:_(o(d).e("error"))},nt(o(l)("el.image.error")),3)]):(x(),P(le,{key:1},[p.value!==void 0?(x(),P("img",Qe({key:0},o(v),{src:p.value,loading:r.loading,style:o(U),class:o($),onClick:G,onLoad:A,onError:Y}),null,16,$t)):O("v-if",!0),E.value?(x(),P("div",{key:1,class:_(o(d).e("wrapper"))},[re(r.$slots,"placeholder",{},()=>[L("div",{class:_(o(d).e("placeholder"))},null,2)])],2)):O("v-if",!0)],64)),o(F)?(x(),P(le,{key:2},[b.value?(x(),me(o(Nt),{key:0,"z-index":r.zIndex,"initial-index":o(H),infinite:r.infinite,"zoom-rate":r.zoomRate,"url-list":r.previewSrcList,"hide-on-click-modal":r.hideOnClickModal,teleported:r.previewTeleported,"close-on-press-escape":r.closeOnPressEscape,onClose:te,onSwitch:ne},{default:z(()=>[r.$slots.viewer?(x(),P("div",At,[re(r.$slots,"viewer")])):O("v-if",!0)]),_:3},8,["z-index","initial-index","infinite","zoom-rate","url-list","hide-on-click-modal","teleported","close-on-press-escape"])):O("v-if",!0)],64)):O("v-if",!0)],6))}});var Pt=Te(Mt,[["__file","/home/runner/work/element-plus/element-plus/packages/components/image/src/image.vue"]]);const Ht=Le(Pt);const{config:se}=st();function Xt(e,a){const t={owner:se.owner,repo:se.repo,branch:se.branch,path:a};return se.url_rules_match[e].replace(/{{(.*?)}}/g,(n,l)=>t[l])}export{Ht as E,Wt as a,ht as d,Xt as g,Ft as s,Et as u};
